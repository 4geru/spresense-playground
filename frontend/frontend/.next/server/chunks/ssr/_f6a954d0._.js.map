{"version":3,"sources":["turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/vendored/contexts/app-router-context.ts","turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-server-dom-turbopack-client.ts","turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-dom.ts","turbopack:///[project]/app/page.tsx"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].AppRouterContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactServerDOMTurbopackClient\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactDOM\n","'use client';\n\nimport { useEffect, useState, useCallback } from 'react';\nimport Image from 'next/image';\nimport Link from 'next/link';\n\ninterface ImageData {\n  name: string;\n  url: string;\n  created_at: string;\n  size: number;\n}\n\nexport default function SlideshowPage() {\n  const [images, setImages] = useState<ImageData[]>([]);\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [notification, setNotification] = useState<string | null>(null);\n  const [lastImageCount, setLastImageCount] = useState(0);\n  const [currentTime, setCurrentTime] = useState('');\n\n  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\n  const supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\n\n  // ÁîªÂÉè„ÇíË™≠„ÅøËæº„ÇÄ\n  const loadImages = useCallback(async () => {\n    try {\n      if (!supabaseUrl || !supabaseKey) {\n        throw new Error('Supabase configuration missing');\n      }\n\n      const response = await fetch(`${supabaseUrl}/functions/v1/get-original-images`, {\n        method: 'GET',\n        headers: {\n          'Authorization': `Bearer ${supabaseKey}`,\n          'apikey': supabaseKey,\n          'Content-Type': 'application/json'\n        }\n      });\n\n      if (!response.ok) {\n        const errorText = await response.text();\n        throw new Error(`HTTP error! status: ${response.status} - ${errorText}`);\n      }\n\n      const result = await response.json();\n\n      if (result.success && result.images) {\n        const imageList = result.images.map((image: any) => ({\n          name: image.name,\n          url: image.url,\n          created_at: image.created_at,\n          size: image.size\n        }));\n\n        setImages(imageList);\n        setLastImageCount(imageList.length);\n\n        if (imageList.length > 0) {\n          setCurrentIndex(Math.floor(Math.random() * imageList.length));\n          setLoading(false);\n        } else {\n          throw new Error('No images found with \"original_capture\" in filename');\n        }\n      } else {\n        throw new Error(result.error || 'No images returned from Edge Function');\n      }\n    } catch (err) {\n      console.error('Error loading images:', err);\n      setError(err instanceof Error ? err.message : 'Failed to load images');\n      setLoading(false);\n    }\n  }, [supabaseUrl, supabaseKey]);\n\n  // Êñ∞„Åó„ÅÑÁîªÂÉè„Çí„ÉÅ„Çß„ÉÉ„ÇØ\n  const checkForNewImages = useCallback(async () => {\n    try {\n      if (!supabaseUrl || !supabaseKey) return;\n\n      const response = await fetch(`${supabaseUrl}/functions/v1/get-original-images`, {\n        method: 'GET',\n        headers: {\n          'Authorization': `Bearer ${supabaseKey}`,\n          'apikey': supabaseKey,\n          'Content-Type': 'application/json'\n        }\n      });\n\n      if (!response.ok) return;\n\n      const result = await response.json();\n\n      if (result.success && result.images) {\n        const newImageCount = result.images.length;\n\n        if (newImageCount > lastImageCount) {\n          console.log(`üÜï New images detected! ${lastImageCount} ‚Üí ${newImageCount}`);\n\n          const imageList = result.images.map((image: any) => ({\n            name: image.name,\n            url: image.url,\n            created_at: image.created_at,\n            size: image.size\n          }));\n\n          setImages(imageList);\n          setLastImageCount(newImageCount);\n          setCurrentIndex(Math.floor(Math.random() * imageList.length));\n\n          setNotification(`üÜï ${newImageCount - lastImageCount} new image${newImageCount - lastImageCount > 1 ? 's' : ''} detected!`);\n          setTimeout(() => setNotification(null), 3000);\n        }\n      }\n    } catch (err) {\n      console.error('Error checking for new images:', err);\n    }\n  }, [supabaseUrl, supabaseKey, lastImageCount]);\n\n  // Ê¨°„ÅÆÁîªÂÉè„Å´ÁßªÂãï\n  const nextImage = useCallback(() => {\n    if (images.length === 0) return;\n\n    let nextIndex;\n    if (images.length > 1) {\n      do {\n        nextIndex = Math.floor(Math.random() * images.length);\n      } while (nextIndex === currentIndex);\n    } else {\n      nextIndex = 0;\n    }\n\n    setCurrentIndex(nextIndex);\n  }, [images.length, currentIndex]);\n\n  // ÂàùÊúüË™≠„ÅøËæº„Åø\n  useEffect(() => {\n    loadImages();\n  }, [loadImages]);\n\n  // „Çπ„É©„Ç§„Éâ„Ç∑„Éß„Éº\n  useEffect(() => {\n    if (images.length <= 1) return;\n\n    const getRandomInterval = () => Math.floor(Math.random() * 1000) + 2000; // 2-3Áßí\n\n    const scheduleNext = () => {\n      const interval = getRandomInterval();\n      const timer = setTimeout(() => {\n        nextImage();\n      }, interval);\n      return timer;\n    };\n\n    const timer = scheduleNext();\n    return () => clearTimeout(timer);\n  }, [images.length, nextImage, currentIndex]);\n\n  // Ëá™Âãï„É™„Éï„É¨„ÉÉ„Ç∑„É•Ôºà30Áßí„Åî„Å®Ôºâ\n  useEffect(() => {\n    const interval = setInterval(() => {\n      checkForNewImages();\n    }, 30000);\n\n    return () => clearInterval(interval);\n  }, [checkForNewImages]);\n\n  // ÊôÇÂàªÊõ¥Êñ∞\n  useEffect(() => {\n    const updateTime = () => {\n      setCurrentTime(new Date().toLocaleTimeString());\n    };\n\n    updateTime();\n    const interval = setInterval(updateTime, 1000);\n\n    return () => clearInterval(interval);\n  }, []);\n\n  if (loading) {\n    return (\n      <div className=\"flex min-h-screen items-center justify-center bg-black\">\n        <div className=\"text-white text-2xl\">Loading images...</div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"flex min-h-screen items-center justify-center bg-black\">\n        <div className=\"text-red-400 text-xl text-center\">\n          <p>Failed to load images from Supabase</p>\n          <p className=\"mt-2\">Please check your connection and configuration</p>\n          <p className=\"mt-4 text-sm\">{error}</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"relative w-screen h-screen bg-black overflow-hidden\">\n      {/* ÈÄöÁü• */}\n      {notification && (\n        <div className=\"fixed top-5 right-5 bg-green-500 bg-opacity-90 text-white px-5 py-4 rounded-lg text-base z-[2000] shadow-lg animate-slide-in\">\n          {notification}\n        </div>\n      )}\n\n      {/* „Çπ„ÉÜ„Éº„Çø„Çπ„Ç§„É≥„Ç∏„Ç±„Éº„Çø„Éº */}\n      <div className=\"fixed top-5 left-5 bg-black bg-opacity-70 text-white px-4 py-2 rounded-md text-sm z-[2000]\">\n        üì∏ Images: {images.length} | üïí {currentTime}\n      </div>\n\n      {/* ÁîªÂÉè‰∏ÄË¶ß„Å∏„ÅÆ„É™„É≥„ÇØ */}\n      <Link\n        href=\"/slides\"\n        className=\"fixed top-5 left-1/2 -translate-x-1/2 bg-purple-600 bg-opacity-90 hover:bg-opacity-100 text-white px-6 py-2 rounded-lg text-sm z-[2000] transition shadow-lg\"\n      >\n        üì∑ View Gallery\n      </Link>\n\n      {/* „Çπ„É©„Ç§„Éâ„Ç∑„Éß„Éº */}\n      {images.length > 0 && (\n        <div className=\"w-full h-full flex items-center justify-center\">\n          <div className=\"relative w-full h-full\">\n            <Image\n              src={images[currentIndex].url}\n              alt={images[currentIndex].name}\n              fill\n              className=\"object-contain\"\n              priority\n              unoptimized // Supabase„ÅÆÁîªÂÉè„Å™„ÅÆ„ÅßÊúÄÈÅ©Âåñ„Çí„Çπ„Ç≠„ÉÉ„Éó\n            />\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":["module","exports","require","vendored","AppRouterContext","ReactServerDOMTurbopackClient","ReactDOM"],"mappings":"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","ignoreList":[0,1,2]}