{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/4geru/space/spresense/spresense-slideshow/contexts/LiffContext.tsx"],"sourcesContent":["'use client';\n\nimport { createContext, useContext, useEffect, useState, ReactNode } from 'react';\nimport liff from '@line/liff';\n\nexport interface LiffProfile {\n  userId: string;\n  displayName: string;\n  pictureUrl?: string;\n  statusMessage?: string;\n}\n\ninterface LiffContextType {\n  isLoggedIn: boolean;\n  profile: LiffProfile | null;\n  isLiffReady: boolean;\n  error: string | null;\n  login: () => void;\n  logout: () => void;\n  sendMessage: (message: string) => Promise<void>;\n  closeWindow: () => void;\n  shareTargetPicker: (messages: any[]) => Promise<any>;\n  isInClient: boolean;\n}\n\nconst LiffContext = createContext<LiffContextType | undefined>(undefined);\n\nexport function LiffProvider({ children }: { children: ReactNode }) {\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\n  const [profile, setProfile] = useState<LiffProfile | null>(null);\n  const [isLiffReady, setIsLiffReady] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    let timeoutId: NodeJS.Timeout | null = null;\n\n    const initLiff = async () => {\n      try {\n        console.log('üöÄ LIFF initialization started');\n        const liffId = process.env.NEXT_PUBLIC_LIFF_ID;\n        console.log('üìù LIFF ID:', liffId ? 'Found' : 'Not found');\n\n        if (!liffId) {\n          console.error('‚ùå LIFF ID is not configured');\n          setError('LIFF ID is not configured');\n          setIsLiffReady(true);\n          if (timeoutId) clearTimeout(timeoutId);\n          return;\n        }\n\n        // „Åô„Åß„Å´ÂàùÊúüÂåñÊ∏à„Åø„Åã„ÉÅ„Çß„ÉÉ„ÇØ\n        console.log('üîç Checking if LIFF is already initialized...');\n        try {\n          const isLoggedInStatus = liff.isLoggedIn();\n          console.log('‚úÖ LIFF already initialized, logged in:', isLoggedInStatus);\n\n          if (isLoggedInStatus) {\n            setIsLiffReady(true);\n            setIsLoggedIn(true);\n            if (timeoutId) clearTimeout(timeoutId);\n\n            try {\n              console.log('üë§ Fetching user profile...');\n              const userProfile = await liff.getProfile();\n              console.log('‚úÖ Profile fetched:', userProfile.displayName);\n              setProfile({\n                userId: userProfile.userId,\n                displayName: userProfile.displayName,\n                pictureUrl: userProfile.pictureUrl,\n                statusMessage: userProfile.statusMessage,\n              });\n            } catch (profileErr) {\n              console.error('‚ùå Profile fetch failed:', profileErr);\n            }\n            return;\n          } else {\n            console.log('‚ÑπÔ∏è LIFF initialized but not logged in');\n            setIsLiffReady(true);\n            if (timeoutId) clearTimeout(timeoutId);\n            return;\n          }\n        } catch (checkErr) {\n          console.log('‚ÑπÔ∏è LIFF not yet initialized, proceeding with init...');\n        }\n\n        // ÂàùÂõûÂàùÊúüÂåñ\n        console.log('üîß Starting LIFF init...');\n        await liff.init({ liffId });\n        console.log('‚úÖ LIFF init completed');\n        setIsLiffReady(true);\n        if (timeoutId) clearTimeout(timeoutId);\n\n        const isLoggedInStatus = liff.isLoggedIn();\n        console.log('üîê Login status after init:', isLoggedInStatus);\n\n        if (isLoggedInStatus) {\n          setIsLoggedIn(true);\n\n          console.log('üë§ Fetching user profile...');\n          const userProfile = await liff.getProfile();\n          console.log('‚úÖ Profile fetched:', userProfile.displayName);\n          setProfile({\n            userId: userProfile.userId,\n            displayName: userProfile.displayName,\n            pictureUrl: userProfile.pictureUrl,\n            statusMessage: userProfile.statusMessage,\n          });\n        }\n      } catch (err) {\n        console.error('‚ùå LIFF initialization failed:', err);\n        const errorMessage = err instanceof Error ? err.message : 'LIFF initialization failed';\n        console.error('Error details:', errorMessage);\n        setError(errorMessage);\n        setIsLiffReady(true);\n        if (timeoutId) clearTimeout(timeoutId);\n      }\n    };\n\n    // „Çø„Ç§„É†„Ç¢„Ç¶„ÉàÂá¶ÁêÜ: 30ÁßíÁµå„Å£„Å¶„ÇÇÂàùÊúüÂåñ„ÅåÂÆå‰∫Ü„Åó„Å™„ÅÑÂ†¥Âêà„ÅØ„Ç®„É©„Éº\n    timeoutId = setTimeout(() => {\n      console.error('‚è∞ LIFF initialization timeout (30 seconds)');\n      setError('LIFF initialization timeout. Please reload the page.');\n      setIsLiffReady(true);\n    }, 30000);\n\n    initLiff();\n\n    return () => {\n      if (timeoutId) {\n        clearTimeout(timeoutId);\n      }\n    };\n  }, []);\n\n  const login = () => {\n    if (!isLiffReady) {\n      console.warn('LIFF is not ready yet');\n      return;\n    }\n    liff.login();\n  };\n\n  const logout = () => {\n    if (!isLiffReady) {\n      console.warn('LIFF is not ready yet');\n      return;\n    }\n    liff.logout();\n    setIsLoggedIn(false);\n    setProfile(null);\n  };\n\n  const sendMessage = async (message: string) => {\n    if (!isLiffReady) {\n      throw new Error('LIFF is not ready');\n    }\n\n    if (!liff.isInClient()) {\n      throw new Error('This feature is only available in LINE app');\n    }\n\n    await liff.sendMessages([\n      {\n        type: 'text',\n        text: message,\n      },\n    ]);\n  };\n\n  const closeWindow = () => {\n    if (!isLiffReady) {\n      console.warn('LIFF is not ready yet');\n      return;\n    }\n    liff.closeWindow();\n  };\n\n  const shareTargetPicker = async (messages: any[]) => {\n    if (!isLiffReady) {\n      throw new Error('LIFF is not ready');\n    }\n\n    // „Éá„Éê„ÉÉ„Ç∞ÊÉÖÂ†±„ÇíÂá∫Âäõ\n    console.log('LIFF Debug Info:', {\n      isInClient: liff.isInClient(),\n      isLoggedIn: liff.isLoggedIn(),\n      os: liff.getOS(),\n      language: liff.getLanguage(),\n      version: liff.getVersion(),\n      lineVersion: liff.getLineVersion(),\n      isApiAvailable: liff.isApiAvailable('shareTargetPicker'),\n    });\n\n    if (!liff.isInClient()) {\n      throw new Error('ShareTargetPicker is only available in LINE app. Please open this page in LINE app.');\n    }\n\n    if (!liff.isApiAvailable('shareTargetPicker')) {\n      throw new Error('ShareTargetPicker is not available. Please check LIFF app settings (Scope: chat_message.write required).');\n    }\n\n    try {\n      const result = await liff.shareTargetPicker(messages);\n      return result;\n    } catch (err) {\n      console.error('ShareTargetPicker error:', err);\n      throw err;\n    }\n  };\n\n  const value: LiffContextType = {\n    isLoggedIn,\n    profile,\n    isLiffReady,\n    error,\n    login,\n    logout,\n    sendMessage,\n    closeWindow,\n    shareTargetPicker,\n    isInClient: isLiffReady ? liff.isInClient() : false,\n  };\n\n  return <LiffContext.Provider value={value}>{children}</LiffContext.Provider>;\n}\n\nexport function useLiff() {\n  const context = useContext(LiffContext);\n  if (context === undefined) {\n    throw new Error('useLiff must be used within a LiffProvider');\n  }\n  return context;\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 225, "column": 0}, "map": {"version":3,"sources":["file:///Users/4geru/space/spresense/spresense-slideshow/components/ErrorBoundary.tsx"],"sourcesContent":["'use client';\n\nimport { Component, ReactNode } from 'react';\nimport { MESSAGE_TEMPLATES } from '@/lib/constants';\n\ninterface ErrorBoundaryProps {\n  children: ReactNode;\n  fallback?: ReactNode;\n}\n\ninterface ErrorBoundaryState {\n  hasError: boolean;\n  error: Error | null;\n}\n\n/**\n * Error Boundary component\n * Catches JavaScript errors anywhere in the child component tree\n */\nexport default class ErrorBoundary extends Component<ErrorBoundaryProps, ErrorBoundaryState> {\n  constructor(props: ErrorBoundaryProps) {\n    super(props);\n    this.state = { hasError: false, error: null };\n  }\n\n  static getDerivedStateFromError(error: Error): ErrorBoundaryState {\n    return { hasError: true, error };\n  }\n\n  componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {\n    console.error('ErrorBoundary caught an error:', error, errorInfo);\n  }\n\n  render() {\n    if (this.state.hasError) {\n      if (this.props.fallback) {\n        return this.props.fallback;\n      }\n\n      return (\n        <div className=\"min-h-screen flex items-center justify-center bg-gray-900 p-4\">\n          <div className=\"max-w-md w-full bg-gray-800 rounded-lg shadow-xl p-8 text-center\">\n            <div className=\"text-6xl mb-4\">‚ö†Ô∏è</div>\n            <h1 className=\"text-2xl font-bold text-white mb-4\">\n              „Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü\n            </h1>\n            <p className=\"text-gray-300 mb-6\">\n              Áî≥„ÅóË®≥„Åî„Åñ„ÅÑ„Åæ„Åõ„Çì„ÄÇ‰∫àÊúü„Åó„Å™„ÅÑ„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü„ÄÇ\n            </p>\n            {this.state.error && (\n              <details className=\"text-left mb-6\">\n                <summary className=\"text-sm text-gray-400 cursor-pointer hover:text-gray-300 mb-2\">\n                  „Ç®„É©„ÉºË©≥Á¥∞\n                </summary>\n                <pre className=\"text-xs text-red-400 bg-gray-900 p-4 rounded overflow-auto max-h-40\">\n                  {this.state.error.message}\n                </pre>\n              </details>\n            )}\n            <button\n              onClick={() => window.location.href = '/'}\n              className=\"bg-[#06C755] hover:bg-[#05b34c] text-white px-6 py-3 rounded-lg transition w-full\"\n            >\n              „Éõ„Éº„É†„Å´Êàª„Çã\n            </button>\n          </div>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAmBe,MAAM,sBAAsB,0KAAS;IAClD,YAAY,KAAyB,CAAE;QACrC,KAAK,CAAC;QACN,IAAI,CAAC,KAAK,GAAG;YAAE,UAAU;YAAO,OAAO;QAAK;IAC9C;IAEA,OAAO,yBAAyB,KAAY,EAAsB;QAChE,OAAO;YAAE,UAAU;YAAM;QAAM;IACjC;IAEA,kBAAkB,KAAY,EAAE,SAA0B,EAAE;QAC1D,QAAQ,KAAK,CAAC,kCAAkC,OAAO;IACzD;IAEA,SAAS;QACP,IAAI,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE;YACvB,IAAI,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE;gBACvB,OAAO,IAAI,CAAC,KAAK,CAAC,QAAQ;YAC5B;YAEA,qBACE,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAI,WAAU;sCAAgB;;;;;;sCAC/B,6LAAC;4BAAG,WAAU;sCAAqC;;;;;;sCAGnD,6LAAC;4BAAE,WAAU;sCAAqB;;;;;;wBAGjC,IAAI,CAAC,KAAK,CAAC,KAAK,kBACf,6LAAC;4BAAQ,WAAU;;8CACjB,6LAAC;oCAAQ,WAAU;8CAAgE;;;;;;8CAGnF,6LAAC;oCAAI,WAAU;8CACZ,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,OAAO;;;;;;;;;;;;sCAI/B,6LAAC;4BACC,SAAS,IAAM,OAAO,QAAQ,CAAC,IAAI,GAAG;4BACtC,WAAU;sCACX;;;;;;;;;;;;;;;;;QAMT;QAEA,OAAO,IAAI,CAAC,KAAK,CAAC,QAAQ;IAC5B;AACF","debugId":null}}]
}